<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="maximum-scale=1.0, minimum-scale=1.0, user-scalable=0, initial-scale=1.0, width=device-width"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="./css/main.css" />
<title>Code Case</title>
</head>

<body>
<div class="container"></div>
</body>
<script type="text/javascript" src="./js/main.js"></script>
<script>
{


console.log('%c=> 寄生组合式继承', 'color: #ff0000;')
function Animal(type) {
    this.type = type
    /* 引用类型的属性 */
    this.features = [`move`]
    /* 本地方法 */
    this.talk = function() {
        return `I can talk.`
    }
}
Animal.prototype.phyComposition = [`heart*1`]
Animal.prototype.ptt = `Animal PTT`
Animal.prototype.eat = function() {
    return `A(n) ${this.type} his name is ${this.name || '-'} is eating.`
}

function Person(name) {
    Animal.call(this, 'human')
    this.name = name
    this.hobbies = []
}
Person.prototype.work = function() {
    return `${this.name} is working.`
}

/* 
    寄生组合式继承
        1. 无法继承父类的本地属性和本地方法(需要在子类中以 call 方式执行父类)
        2. 子类实例对继承自父类 prototype 上的引用属性做修改时将影响到子类和父类的实例
*/
function classExtends(Child, Parent) {
    const prototype = createBridgingInstance(Parent.prototype)
    // const prototype = Object.create(Parent.prototype)
    Child.prototype = prototype
    Child.prototype.constructor = Child
}
function createBridgingInstance(reference) {
    function Bridging() {}
    Bridging.prototype = reference
    Bridging.prototype.constructor = Bridging
    return new Bridging()
}

function Person(name) {
    Animal.call(this, 'human')
    this.name = name
    this.hobbies = []
}
classExtends(Person, Animal)
Person.prototype.work = function() {
    return `${this.name} is working.`
}

const dog = new Animal('dog')
console.log(`\n··· dog >>>`)
console.log(dog)
console.log(dog.eat())
dog.features.push(`fly`)

const alex = new Person('alex')
console.log(`\n··· alex >>>`)
console.log(alex)
console.log(alex.eat())
console.log(alex.work())
alex.phyComposition.push(`kidney*3`)

const json = new Person('json')
json.features.push(`swim`)
json.hobbies.push(`read`)
console.log(`\n··· json >>>`)
console.log(json)
console.log(json.eat())
console.log(json.work())


}
</script>
</html>